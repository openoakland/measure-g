<!DOCTYPE html>
<html>
		<head>
			<title>
				Tree Map | Measure G Data Explorer
			</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
		<style>

		body {
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			margin: auto;
			position: relative;
			/*width: 960px;*/
		}

		form {
			position: relative;
			left: 10px;
			top: 10px;
		}

		.node {
			border: solid 1px white;
			font: 10px sans-serif;
			line-height: 12px;
			overflow: hidden;
			position: absolute;
			text-indent: 2px;
		}

		</style>
	</head>

	<body>
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<a class="navbar-brand" href="index.html"><strong>Measure-g</strong></a>
				</div>

				<ul class="nav navbar-nav">
					<li><a href="index.html">Geographic Map</a></li>
					<li class="active"><a href="demo.html">Tree Map</a></li>
				</ul>
			</div>
		</nav>

		<div class="container-fluid">
			<div class="row">
				<div class="col-xs-12 col-sm-2 col-sm-offset-5">
					<form>
						<label><input type="radio" name="mode" value="size" checked> Size</label>
						<label><input type="radio" name="mode" value="count"> Count</label>
					</form>
				</div>
			</div>
		</div>

		<div id="treeMapDiv"></div>


		<script src="http://d3js.org/d3.v3.min.js"></script>
		<script>

		var treeMap = document.getElementById("treeMapDiv");

		var margin = {top: 40, right: 10, bottom: 10, left: 10},
				width = 1040 - margin.left - margin.right,
				height = 600 - margin.top - margin.bottom;

		var color = d3.scale.category20c();

		var treemap = d3.layout.treemap()
				.size([width, height])
				.sticky(true)
				.value(function(d) { return d.sum; });

		var div = d3.select("#treeMapDiv").append("div")
				.style("position", "relative")
				.style("width", (width + margin.left + margin.right) + "px")
				.style("height", (height + margin.top + margin.bottom) + "px")
				.style("left", margin.left + "px")
				.style("top", margin.top + "px")
				.style("margin-left", "auto")
				.style("margin-right", "auto");

		d3.json("http://measureg.nfshost.com/data.json", function(error, root) {
			var node = div.datum(root).selectAll(".node")
					.data(treemap.nodes)
				.enter().append("div")
					.attr("class", "node")
					.call(position)
					.style("background", function(d) { return d.children ? color(d.name) : null; })
					.text(function(d) { return d.children ? null : d.name; });

			d3.selectAll("input").on("change", function change() {
				var value = this.value === "count"
						? function() { return 1; }
						: function(d) { return d.sum; };

				node
						.data(treemap.value(value).nodes)
					.transition()
						.duration(1500)
						.call(position);
			});
		});

		function position() {
			this.style("left", function(d) { return d.x + "px"; })
					.style("top", function(d) { return d.y + "px"; })
					.style("width", function(d) { return Math.max(0, d.dx - 1) + "px"; })
					.style("height", function(d) { return Math.max(0, d.dy - 1) + "px"; });
		}

		</script>
	</body>
</html>